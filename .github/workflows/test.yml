name: CI
on: [push]
jobs:
  test:
    strategy:
      matrix:
        os: [windows-latest]
        python-version: [ 3.10.4 ]
        include:
          - os: ubuntu-latest
            python-version: 3.8.x

    runs-on: ${{ matrix.os }}
    steps:
      - uses: actions/checkout@v3
      - uses: actions/setup-python@v3
        with:
          python-version: ${{ matrix.python-version }}

      - id: run-basic-test
        run: echo "::set-output name=OUTPUT::$(tests/basic.ps1)"

      - id: check-result
        if: steps.run-basic-test.outputs.OUTPUT != 'Applesauce'
        run: |
          echo "OUTPUT was '${{ steps.run-basic-test.outputs.OUTPUT }}'"
          exit 1
  actions-debugging-is-disabled:
    runs-on: ubuntu-latest
    steps:
        - name: Ensure actions debugging is disabled
          run: |
            [[ "${{ secrets.ACTIONS_STEP_DEBUG   }}" != "true" ]] || exit 1
            [[ "${{ secrets.ACTIONS_RUNNER_DEBUG }}" != "true" ]] || exit 1
